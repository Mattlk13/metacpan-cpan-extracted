#!/usr/bin/env perl
package Test2::Harness::Runner;
use strict;
use warnings;

use Test2::Util qw/pkg_to_file/;

my ($class, @args) = @ARGV;

die "Usage: $0 'Test2::Harness::Worker::...' [CONSTRUCTIONS ARGS]\n"
    unless $class;

my $file = pkg_to_file($class);
require $file;

my $worker = $class->new(@args);

my $test_file = $worker->run or exit 0;

$@ = '';
package main;
do $test_file;
die $@ if $@;

exit 0;
