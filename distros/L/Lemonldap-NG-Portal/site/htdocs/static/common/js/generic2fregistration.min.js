(function(){var o,e,s,r;s=function(e,r){return $("#msg").attr("trspan",e),$("#msg").html(window.translate(e)),$("#color").removeClass("message-positive message-warning message-danger alert-success alert-warning alert-danger"),$("#color").addClass("message-"+r),"positive"===r&&(r="success"),$("#color").addClass("alert-"+r),$("#msg").attr("role","danger"===r?"alert":"status")},o=function(e,r,n){var a;if(console.log("Error",n),(a=JSON.parse(e.responseText))&&a.error)return a=a.error.replace(/.* /,""),console.log("Returned error",a),s(a,"warning")},r=function(){var e,r;return e=$("#generic").val(),r=window.datas.prefix,e?$.ajax({type:"POST",url:portal+"2fregisters/"+r+"/sendcode",dataType:"json",data:{generic:e},error:o,success:function(e){return e.error?e.error.match(/PE79/)?s(e.error,"warning"):s(e.error,"danger"):($("#token").val(e.token),s("genericCheckCode","success"))}}):(s("PE79","warning"),$("#generic").focus())},e=function(){var e,r,n,a,t;return e=$("#generic").val(),n=$("#genericname").val(),r=$("#code").val(),a=window.datas.prefix,t=$("#token").val(),e?$.ajax({type:"POST",url:portal+"2fregisters/"+a+"/verify",dataType:"json",data:{generic:e,genericname:n,genericcode:r,token:t},error:o,success:function(e){var r;return e.error?e.error.match(/mailNotSent/)?s(e.error,"warning"):s(e.error,"danger"):(r=jQuery.Event("mfaAdded"),$(document).trigger(r,[{type:a}]),r.isDefaultPrevented()?void 0:s("genericRegistered","success"))}}):(s("PE79","warning"),$("#generic").focus())},$(document).ready(function(){return $("#verify").on("click",r),$("#register").on("click",e)})}).call(this);