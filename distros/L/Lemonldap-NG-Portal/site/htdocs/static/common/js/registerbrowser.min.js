!function(){var n,o,r,t,i,l,a;$(document).ready(function(){return window.requestIdleCallback?requestIdleCallback(function(){return t()}):setTimeout(t,500)}),t=function(){var e,t;if(window.localStorage){if(t=$("#totpsecret").attr("value"))try{localStorage.setItem("stayconnectedkey",t)}catch(t){e=t,console.error("Unable to register key in storage",e)}else t=localStorage.getItem("stayconnectedkey");if(t)try{return $("#fg").attr("value","TOTP_"+r(t)),void $("#form").submit()}catch(t){e=t,console.error("Unable to register key in storage",e)}}return(t=document.createElement("script")).src=window.staticPrefix+"bwr/fingerprintjs2/fingerprint2.js",t.async=!1,document.body.append(t),t.onload=a,setTimeout(a,1e3)},a=function(){return console.log("Trying fingerprint"),window.Fingerprint2?Fingerprint2.get(function(t){t=t.map(function(t){return t.value}),t=Fingerprint2.x64hash128(t.join(""),31);return $("#fg").attr("value",t),$("#form").submit()}):(console.error("No way to register this device"),$("#form").submit())},r=function(t){var e,r;return t=n(t),r=l(o(Math.floor(Date.now()/3e4)),16,"0"),(e=new jsSHA("SHA-1","HEX")).setHMACKey(t,"HEX"),e.update(r),t=e.getHMAC("HEX"),r=i(t.substring(t.length-1)),(e=(i(t.substr(2*r,8))&i("7fffffff"))+"").substr(Math.max(e.length-6,0),6)},i=function(t){return parseInt(t,16)},o=function(t){return(t<15.5?"0":"")+Math.round(t).toString(16)},n=function(t){for(var e,r,n,o,i,a="",c="",s=r=0,u=(t=t.replace(/=+$/,"")).length-1;0<=u?r<=u:u<=r;s=0<=u?++r:--r){if(-1===(i="ABCDEFGHIJKLMNOPQRSTUVWXYZ234567".indexOf(t.charAt(s).toUpperCase())))throw new Error("Invalid base32 character in key");a+=l(i.toString(2),5,"0")}for(s=n=0,o=a.length-8;n<=o;s=n+=8)e=a.substr(s,8),c+=l(parseInt(e,2).toString(16),2,"0");return c},l=function(t,e,r){return t=e+1>=t.length?Array(e+1-t.length).join(r)+t:t}}.call(this);