!function(){var P,t,L,j,E,A,I,D,G,e,z,p,R=[].indexOf||function(e){for(var t=0,a=this.length;t<a;t++)if(t in this&&this[t]===e)return t;return-1},s={},N=function(e,t){var a=!1;return e?($("#"+t).addClass("fa-check text-success"),$("#"+t).removeClass("fa-times text-danger"),$("#"+t).attr("role","status")):($("#"+t).addClass("fa-times text-danger"),$("#"+t).removeClass("fa-check text-success"),$("#"+t).attr("role","alert"),a=!0),a},U=function(r){return $.getJSON(window.staticPrefix+"languages/"+r+".json",function(e){var t,a,o,n;for(t in s=e,a=window.datas.trOver.all)n=a[t],s[t]=n;if(window.datas.trOver[r])for(t in o=window.datas.trOver[r])n=o[t],s[t]=n;return $("[trspan]").each(function(){for(var e=$(this).attr("trspan").split(","),t=V(e.shift()),a=0,o=e.length;a<o;a++)n=e[a],t=t.replace(/%[sd]/,n);return $(this).html(t)}),$("[trmsg]").each(function(){if($(this).html(V("PE"+$(this).attr("trmsg"))),V("PE"+$(this).attr("trmsg")).match(/_hide_/))return $(this).parent().hide()}),$("[trplaceholder]").each(function(){var e=V($(this).attr("trplaceholder"));return $(this).attr("placeholder",e),$(this).attr("aria-label",e)}),$("[localtime]").each(function(){var e=new Date(1e3*$(this).attr("localtime"));return $(this).text(e.toLocaleString())})})},V=function(e){return s[e]||e};window.translate=V,E=function(){var o={};return $("script[type='application/init']").each(function(){var e,t,a;try{for(e in a=JSON.parse($(this).text()),t=[],a)t.push(o[e]=a[e]);return t}catch(e){return console.log("Parsing error",e),console.log("JSON",$(this).text())}}),console.log(o),o},j=function(e){e=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search);return e?decodeURIComponent(e[1].replace(/\+/g," ")):null},p="#appslist",z=function(){return e("_appsListOrder",$(p).sortable("toArray").join())},I=function(e){return t("_oidcConsents",e,function(){return $("[partner='"+e+"']").hide()},function(e,t,a){return alert(t+" "+a)})},e=function(t,a,o,n){return $.ajax({type:"GET",url:P.scriptname+"/mysession/?gettoken",dataType:"json",error:n,success:function(e){e={token:e.token};return e[t]=a,$.ajax({type:"PUT",url:P.scriptname+"/mysession/persistent",dataType:"json",data:e,success:o,error:n})}})},t=function(t,a,o,n){return $.ajax({type:"GET",url:P.scriptname+"/mysession/?gettoken",dataType:"json",error:n,success:function(e){return $.ajax({type:"DELETE",url:P.scriptname+"/mysession/persistent/"+t+"?sub="+a+"&token="+e.token,dataType:"json",success:o,error:n})}})},D=function(){var e,t,a,o,n,r,s,i,l,c,d=$(p);if(null==d||!P.appslistorder)return null;for(e=P.appslistorder.split(","),i=[],o=0,n=(a=d.sortable("toArray")).length;o<n;o++)i[c=a[o]]=c;for(s=0,r=e.length;s<r;s++)i[l=e[s]]&&(t=i[l],t=$(p+".ui-sortable").children("#"+t),l=$(p+".ui-sortable").children("#"+l),t.remove(),$(p+".ui-sortable").filter(":first").append(l));return 1},A=function(){return $.ajax({type:"POST",url:P.scriptname,data:{ping:1},dataType:"json",success:function(e){return null!=e.result&&1===e.result?setTimeout(A,P.pingInterval):location.reload(!0)},error:function(e,t,a){return location.reload(!0)}})},window.ping=A,L=function(e){for(var t,a=decodeURIComponent(document.cookie).split(";"),o=new RegExp("^ *"+e+"="),n=0,r=a.length;n<r;n++)if((t=a[n]).match(o))return t=t.replace(o,"");return""},G=function(e,t,a,o){var n=new Date;return n.setTime(n.getTime()+864e5*o),document.cookie=e+"="+t+"; expires="+n.toUTCString()+"; path=/; SameSite="+a},P={},$(window).on("load",function(){var e,t,a,o,d,n,r,s,i,l,c,p,u,w,g,f,h,m,y,v,b,k,x,S,C,T,O;if(P=E(),"datas"in window&&"choicetab"in window.datas&&(P.choicetab=window.datas.choicetab),window.datas=P,$("#appslist").sortable({axis:"y",cursor:"move",opacity:.5,revert:!0,items:"> div.category",update:z}),D(),$("div.message").fadeIn("slow"),$("input[name=timezone]").val(-(new Date).getTimezoneOffset()/60),h=$("#menu").tabs({active:0}),f=$('#menu a[href="#'+P.displaytab+'"]').parent().index(),h.tabs("option","active",f=f<0?0:f),t=$("#authMenu").tabs({active:0}),h=$('#authMenu a[href="#'+P.displaytab+'"]').parent().index(),t.tabs("option","active",h=h<0?0:h),P.choicetab&&t.tabs("option","active",$('#authMenu a[href="#'+P.choicetab+'"]').parent().index()),P.login?$("input[type=password]:first").focus():0===$("input[autofocus]").length&&$("input[type!=hidden]:first").focus(),P.newwindow&&$("#appslist a").attr("target","_blank"),$("p.removeOther").length&&(f=$("#form").attr("action"),h=$("#form").attr("method"),console.log("method=",h),o="",$("#form input[type=hidden]")&&(console.log("Parse hidden values"),$("#form input[type=hidden]").each(function(e){return console.log(" ->",$(this).attr("name"),$(this).val()),o+="&"+$(this).attr("name")+"="+$(this).val()})),t="",f&&(console.log("action=",f),-1!==f.indexOf("?")?f.substring(0,f.indexOf("?")):t=f+"?",t+=o,o=""),h=$("p.removeOther a").attr("href")+"&method="+h+o,t&&(h+="&url="+btoa(t)),$("p.removeOther a").attr("href",h)),window.location.search&&((k=j("llnglanguage"))&&console.log("Get lang from parameter"),1===(O=j("setCookieLang"))&&console.log("Set lang cookie")),r||(r=L("llnglanguage"))&&!k&&console.log("Get lang from cookie"),r)R.call(window.availableLanguages,r)<0&&(r=window.availableLanguages[0],k||console.log("Lang not available -> Get default lang"));else if(navigator){for(i=[],l=[],v=[navigator.language],navigator.languages&&(v=navigator.languages),n=0,c=(S=window.availableLanguages).length;n<c;n++)e=S[n],s+='<img class="langicon" src="'+window.staticPrefix+"common/"+e+'.png" title="'+e+'" alt="['+e+']"> ';for(g=0,p=v.length;g<p;g++)for(y=v[g],console.log("Navigator lang",y),m=0,u=(C=window.availableLanguages).length;m<u;m++)e=C[m],console.log(" Available lang",e),x=new RegExp("^"+e+"-?"),y.match(x)?(console.log("  Matching lang =",e),i.push(e)):e.substring(0,1)===y.substring(0,1)&&l.push(e);(r=i[0]||l[0]||window.availableLanguages[0])&&!k&&console.log("Get lang from navigator")}else(r=window.availableLanguages[0])&&!k&&console.log("Get lang from window");for(k?(R.call(window.availableLanguages,k)<0&&(console.log("Lang not available -> Get default lang"),k=window.availableLanguages[0]),console.log("Selected lang ->",k),O&&(console.log("Set cookie lang ->",k),G("llnglanguage",k,P.sameSite)),U(k)):(console.log("Selected lang ->",r),G("llnglanguage",r,P.sameSite),U(r)),s="",b=0,w=(T=window.availableLanguages).length;b<w;b++)e=T[b],s+='<img class="langicon" src="'+window.staticPrefix+"common/"+e+'.png" title="'+e+'" alt="['+e+']"> ';return $("#languages").html(s),$(".langicon").on("click",function(){return r=$(this).attr("title"),G("llnglanguage",r,P.sameSite),U(r)}),d=function(e){e=e.charCodeAt(0);return 47<e&&e<58||64<e&&e<91||96<e&&e<123},a=function(e){var t,a,o,n,r,s,i,l,c=!0;if(0<window.datas.ppolicy.minsize&&N(e.length>=window.datas.ppolicy.minsize,"ppolicy-minsize-feedback")&&(c=!1),0<window.datas.ppolicy.minupper&&(l=e.match(/[A-Z]/g),N(l&&l.length>=window.datas.ppolicy.minupper,"ppolicy-minupper-feedback")&&(c=!1)),0<window.datas.ppolicy.minlower&&(n=e.match(/[a-z]/g),N(n&&n.length>=window.datas.ppolicy.minlower,"ppolicy-minlower-feedback")&&(c=!1)),0<window.datas.ppolicy.mindigit&&(n=e.match(/[0-9]/g),N(n&&n.length>=window.datas.ppolicy.mindigit,"ppolicy-mindigit-feedback")&&(c=!1)),window.datas.ppolicy.allowedspechar){for(r=window.datas.ppolicy.allowedspechar.replace(/\s/g,""),t=!1,a=0,o=e.length;a<o;)d(e.charAt(a))||r.indexOf(e.charAt(a))<0&&(t=!0),a++;N(!1===t,"ppolicy-allowedspechar-feedback")&&(c=!1)}if(0<window.datas.ppolicy.minspechar&&window.datas.ppolicy.allowedspechar){for(s=0,r=window.datas.ppolicy.allowedspechar.replace(/\s/g,""),a=0;a<e.length;)0<=r.indexOf(e.charAt(a))&&s++,a++;N(s>=window.datas.ppolicy.minspechar,"ppolicy-minspechar-feedback")&&(c=!1)}if(0<window.datas.ppolicy.minspechar&&!window.datas.ppolicy.allowedspechar){for(a=s=0;a<e.length;)d(e.charAt(a))||s++,a++;N(s>=window.datas.ppolicy.minspechar,"ppolicy-minspechar-feedback")&&(c=!1)}c?($(".ppolicy").removeClass("border-danger").addClass("border-success"),null!=(i=$("#newpassword").get(0))&&i.setCustomValidity("")):($(".ppolicy").removeClass("border-success").addClass("border-danger"),null!=(i=$("#newpassword").get(0))&&i.setCustomValidity(V("PE28")))},null!=window.datas.ppolicy&&$("#newpassword").length&&(a(""),$("#newpassword").keyup(function(e){a(e.target.value)})),O=function(e){return e.target.checked?($("#newpassword").off("keyup"),null!=(e=$("#newpassword").get(0))?e.setCustomValidity(""):void 0):($("#newpassword").keyup(function(e){a(e.target.value)}),a(""))},k=function(){var e,t;return(null!=(e=$("#confirmpassword").get(0))?e.value:void 0)===(null!=(e=$("#newpassword").get(0))?e.value:void 0)?(null!=(t=$("#confirmpassword").get(0))&&t.setCustomValidity(""),!0):(null!=(t=$("#confirmpassword").get(0))&&t.setCustomValidity(V("PE34")),!1)},$("#newpassword").change(k),$("#confirmpassword").change(k),null!=window.datas.ppolicy&&$("#newpassword").length&&$("#reset").change(O),P.enablePasswordDisplay&&(P.dontStorePassword?($(".toggle-password").mousedown(function(){return $(this).toggleClass("fa-eye fa-eye-slash"),$("input[name=password]").attr("class","form-control")}),$(".toggle-password").mouseup(function(){if($(this).toggleClass("fa-eye fa-eye-slash"),$("input[name=password]").get(0).value)return $("input[name=password]").attr("class","form-control key")})):($(".toggle-password").mousedown(function(){return $(this).toggleClass("fa-eye fa-eye-slash"),$("input[name=password]").attr("type","text")}),$(".toggle-password").mouseup(function(){return $(this).toggleClass("fa-eye fa-eye-slash"),$("input[name=password]").attr("type","password")}))),P.pingInterval&&0<P.pingInterval&&window.setTimeout(A,P.pingInterval),$(".localeDate").each(function(){var e=new Date(1e3*$(this).attr("val"));return $(this).text(e.toLocaleString())}),$(".oidcConsent").on("click",function(){return I($(this).attr("partner"))}),$("#show-hide-button").on("click",function(){return P.dontStorePassword?"form-control key"===$("#newpassword").attr("class")||"form-control key"===$("#confirmpassword").attr("class")?(console.log("Show passwords"),$("#newpassword").attr("class","form-control"),$("#confirmpassword").attr("class","form-control"),$("#show-hide-icon-button").attr("class","fa fa-eye-slash")):(console.log("Hide passwords"),$("#newpassword").get(0).value&&$("#newpassword").attr("class","form-control key"),$("#confirmpassword").get(0).value&&$("#confirmpassword").attr("class","form-control key"),$("#newpassword").get(0).value||$("#confirmpassword").get(0).value?$("#show-hide-icon-button").attr("class","fa fa-eye"):void 0):"password"===$("#newpassword").attr("type")?(console.log("Show passwords"),$("#newpassword").attr("type","text"),$("#confirmpassword").attr("type","text"),$("#show-hide-icon-button").attr("class","fa fa-eye-slash")):(console.log("Hide passwords"),$("#newpassword").attr("type","password"),$("#confirmpassword").attr("type","password"),$("#show-hide-icon-button").attr("class","fa fa-eye"))}),$("#passwordfield").on("input",function(){return $("#passwordfield").get(0).value&&P.dontStorePassword?$("#passwordfield").attr("class","form-control key"):$("#passwordfield").attr("class","form-control")}),$("#oldpassword").on("input",function(){return $("#oldpassword").get(0).value&&P.dontStorePassword?$("#oldpassword").attr("class","form-control key"):$("#oldpassword").attr("class","form-control")}),$("#newpassword").on("input",function(){return $("#newpassword").get(0).value&&P.dontStorePassword?"fa fa-eye"===$("#show-hide-icon-button").attr("class")?$("#newpassword").attr("class","form-control key"):void 0:$("#newpassword").attr("class","form-control")}),$("#confirmpassword").on("input",function(){return $("#confirmpassword").get(0).value&&P.dontStorePassword?"fa fa-eye"===$("#show-hide-icon-button").attr("class")?$("#confirmpassword").attr("class","form-control key"):void 0:$("#confirmpassword").attr("class","form-control")}),$(".clear-finduser-field").on("click",function(){return $(this).parent().find(":input").each(function(){return console.log("Clear search field ->",$(this).attr("name")),$(this).val("")})}),$("#closefinduserform").on("click",function(){return console.log("Clear modal"),$("#finduserForm").trigger("reset")}),$("#finduserbutton").on("click",function(e){return e.preventDefault(),document.body.style.cursor="progress",e=$("#finduserForm").serialize(),console.log("Send findUser request with parameters",e),$.ajax({type:"POST",url:portal+"finduser",dataType:"json",data:e,success:function(e){var t;if(document.body.style.cursor="default",t=e.user,console.log("Suggested spoofId=",t),$("input[name=spoofId]").each(function(){return $(this).val(t)}),e.captcha&&$("#captcha").attr("src",e.captcha),e.token)return $("#finduserToken").val(e.token),$("#token").val(e.token)},error:function(e,t,a){var o;if(document.body.style.cursor="default",a&&console.log("Error",a),(o=e?JSON.parse(e.responseText):o)&&o.error)return console.log("Returned error",o)}})})})}.call(this);