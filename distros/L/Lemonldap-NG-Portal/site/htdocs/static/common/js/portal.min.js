(function(){var e,t,o,a,n,r,s,i,l,c,d,u,p,g,f,w,h=[].indexOf||function(e){for(var t=0,o=this.length;t<o;t++)if(t in this&&this[t]===e)return t;return-1};w={},c=function(e,t){var o;return o=!1,e?($("#"+t).addClass("fa-check text-success"),$("#"+t).removeClass("fa-times text-danger"),$("#"+t).attr("role","status")):($("#"+t).addClass("fa-times text-danger"),$("#"+t).removeClass("fa-check text-success"),$("#"+t).attr("role","alert"),o=!0),o},f=function(e){return $.getJSON(window.staticPrefix+"languages/"+e+".json",function(t){var o,a,n,r;w=t,a=window.datas.trOver.all;for(o in a)r=a[o],w[o]=r;if(window.datas.trOver[e]){n=window.datas.trOver[e];for(o in n)r=n[o],w[o]=r}return $("[trspan]").each(function(){var e,t,o,a;for(e=$(this).attr("trspan").split(","),a=g(e.shift()),t=0,o=e.length;t<o;t++)r=e[t],a=a.replace(/%[sd]/,r);return $(this).html(a)}),$("[trmsg]").each(function(){var e;if($(this).html(g("PE"+$(this).attr("trmsg"))),e=g("PE"+$(this).attr("trmsg")),e.match(/_hide_/))return $(this).parent().hide()}),$("[trattribute]").each(function(){var e,t,o,a,n,r,s;for(r=$(this).attr("trattribute").trim().split(/\s+/),t=0,o=r.length;t<o;t++)n=r[t],a=n.split(":"),e=a[0],s=a[1],e&&s&&$(this).attr(e,g(s));return!0}),$("[trplaceholder]").each(function(){var e;return e=g($(this).attr("trplaceholder")),$(this).attr("placeholder",e),$(this).attr("aria-label",e)}),$("[localtime]").each(function(){var e;return e=new Date(1e3*$(this).attr("localtime")),$(this).text(e.toLocaleString())})})},g=function(e){return w[e]?w[e]:e},window.translate=g,n=function(){var e;return e={},$("script[type='application/init']").each(function(){var t,o,a,n;try{n=JSON.parse($(this).text()),a=[];for(o in n)a.push(e[o]=n[o]);return a}catch(e){return t=e,console.log("Parsing error",t),console.log("JSON",$(this).text())}}),console.log(e),e},a=function(e){var t;return t=RegExp("[?&]"+e+"=([^&]*)").exec(window.location.search),t?decodeURIComponent(t[1].replace(/\+/g," ")):null},p="#appslist",u=function(){return d("_appsListOrder",$(p).sortable("toArray").join())},s=function(e){var o;return o=function(e,t,o){return alert(t+" "+o)},t("_oidcConsents",e,function(){return $("[partner='"+e+"']").hide()},o)},d=function(e,t,o,a){return $.ajax({type:"GET",url:scriptname+"mysession/?gettoken",dataType:"json",error:a,success:function(n){var r;return r={token:n.token},r[e]=t,$.ajax({type:"PUT",url:scriptname+"mysession/persistent",dataType:"json",data:r,success:o,error:a})}})},t=function(e,t,o,a){return $.ajax({type:"GET",url:scriptname+"mysession/?gettoken",dataType:"json",error:a,success:function(n){return $.ajax({type:"DELETE",url:scriptname+"mysession/persistent/"+e+"?sub="+t+"&token="+n.token,dataType:"json",success:o,error:a})}})},i=function(){var t,o,a,n,r,s,i,l,c,d,u,g,f;if(null==(c=$(p))||!e.appslistorder)return null;for(t=e.appslistorder.split(","),r=c.sortable("toArray"),u=[],s=0,i=r.length;s<i;s++)f=r[s],u[f]=f;for(d=0,l=t.length;d<l;d++)n=t[d],u[n]&&(a=u[n],o=$(p+".ui-sortable").children("#"+a),g=$(p+".ui-sortable").children("#"+n),o.remove(),$(p+".ui-sortable").filter(":first").append(g));return 1},r=function(){return $.ajax({type:"POST",url:scriptname,data:{ping:1},dataType:"json",success:function(t){return null!=t.result&&1===t.result?setTimeout(r,e.pingInterval):location.reload(!0)},error:function(e,t,o){return location.reload(!0)}})},window.ping=r,o=function(e){var t,o,a,n,r;for(e+"=",o=decodeURIComponent(document.cookie).split(";"),r=new RegExp("^ *"+e+"="),a=0,n=o.length;a<n;a++)if(t=o[a],t.match(r))return t=t.replace(r,"");return""},l=function(t,o,a){var n,r,s,i;return s=e.sameSite,i=e.cookieSecure,n=t+"="+o+"; path=/; SameSite="+s,a&&(r=new Date,r.setTime(r.getTime()+864e5*a),n+="; expires="+r.toUTCString()),i&&(n+="; Secure"),document.cookie=n},e={},$(window).on("load",function(){var t,d,p,w,m,v,y,b,k,x,C,T,S,O,P,L,j,E,A,I,D,G,V,z,R,_,M,N,q,J,U,F,B,Z,H;if(e=n(),"datas"in window&&"choicetab"in window.datas&&(e.choicetab=window.datas.choicetab),window.datas=e,$("#appslist").sortable({axis:"y",cursor:"move",opacity:.5,revert:!0,items:"> div.category",update:function(){return u()}}),i(),$("div.message").fadeIn("slow"),$("input[name=timezone]").val(-(new Date).getTimezoneOffset()/60),V=$("#menu").tabs({active:0}),G=$('#menu a[href="#'+e.displaytab+'"]').parent().index(),G<0&&(G=0),V.tabs("option","active",G),w=$("#authMenu").tabs({active:0}),p=$('#authMenu a[href="#'+e.displaytab+'"]').parent().index(),p<0&&(p=0),w.tabs("option","active",p),e.choicetab&&w.tabs("option","active",$('#authMenu a[href="#'+e.choicetab+'"]').parent().index()),e.login?$("input[type=password]:first").focus():0===$("input[autofocus]").length&&$("input[type!=hidden]:first").focus(),e.newwindow&&$("#appslist a").attr("target","_blank"),$("p.removeOther").length&&(t=$("#form").attr("action"),z=$("#form").attr("method"),console.log("method=",z),k="",$("#form input[type=hidden]")&&(console.log("Parse hidden values"),$("#form input[type=hidden]").each(function(e){return console.log(" ->",$(this).attr("name"),$(this).val()),k+="&"+$(this).attr("name")+"="+$(this).val()})),m="",t&&(console.log("action=",t),-1!==t.indexOf("?")?t.substring(0,t.indexOf("?")):m=t+"?",m+=k,k=""),I=$("p.removeOther a").attr("href")+"&method="+z+k,m&&(I+="&url="+btoa(m)),$("p.removeOther a").attr("href",I)),window.location.search&&(q=a("llnglanguage"),q&&console.log("Get lang from parameter"),1===(Z=a("setCookieLang"))&&console.log("Set lang cookie")),T||(T=o("llnglanguage"))&&!q&&console.log("Get lang from cookie"),T)h.call(window.availableLanguages,T)<0&&(T=window.availableLanguages[0],q||console.log("Lang not available -> Get default lang"));else if(navigator){for(O=[],P=[],M=[navigator.language],navigator.languages&&(M=navigator.languages),U=window.availableLanguages,C=0,L=U.length;C<L;C++)d=U[C],S+='<img class="langicon" src="'+window.staticPrefix+"common/"+d+'.png" title="'+d+'" alt="['+d+']"> ';for(D=0,j=M.length;D<j;D++)for(_=M[D],console.log("Navigator lang",_),F=window.availableLanguages,R=0,E=F.length;R<E;R++)d=F[R],console.log(" Available lang",d),J=new RegExp("^"+d+"-?"),_.match(J)?(console.log("  Matching lang =",d),O.push(d)):d.substring(0,1)===_.substring(0,1)&&P.push(d);T=O[0]?O[0]:P[0]?P[0]:window.availableLanguages[0],T&&!q&&console.log("Get lang from navigator")}else(T=window.availableLanguages[0])&&!q&&console.log("Get lang from window");for(q?(h.call(window.availableLanguages,q)<0&&(console.log("Lang not available -> Get default lang"),q=window.availableLanguages[0]),console.log("Selected lang ->",q),Z&&(console.log("Set cookie lang ->",q),l("llnglanguage",q,3650)),f(q)):(console.log("Selected lang ->",T),f(T)),S="",B=window.availableLanguages,N=0,A=B.length;N<A;N++)d=B[N],S+='<img class="langicon" src="'+window.staticPrefix+"common/"+d+'.png" title="'+d+'" alt="['+d+']"> ';return $("#languages").html(S),$(".langicon").on("click",function(){return T=$(this).attr("title"),l("llnglanguage",T,3650),f(T)}),x=function(e){var t;return(t=e.charCodeAt(0))>47&&t<58||t>64&&t<91||t>96&&t<123},v=function(e,t){var o,a,n,r,s,i,l,d,u,p,f,w;if(f=!0,window.datas.ppolicy.minsize>0&&c(e.length>=window.datas.ppolicy.minsize,"ppolicy-minsize-feedback")&&(f=!1),window.datas.ppolicy.minupper>0&&(w=e.match(/[A-Z]/g),c(w&&w.length>=window.datas.ppolicy.minupper,"ppolicy-minupper-feedback")&&(f=!1)),window.datas.ppolicy.minlower>0&&(s=e.match(/[a-z]/g),c(s&&s.length>=window.datas.ppolicy.minlower,"ppolicy-minlower-feedback")&&(f=!1)),window.datas.ppolicy.mindigit>0&&(o=e.match(/[0-9]/g),c(o&&o.length>=window.datas.ppolicy.mindigit,"ppolicy-mindigit-feedback")&&(f=!1)),$("#ppolicy-checkhibp-feedback").length>0&&("focusout"===t?(i=$("#newpassword").val(),i.length>=5&&$.ajax({dataType:"json",url:"/checkhibp?password="+btoa(i),context:document.body,success:function(e){var t,o;if(t=e.code,o=e.message,void 0!==t)if(0===parseInt(t)){if(c(!0,"ppolicy-checkhibp-feedback"))return f=!1}else if(2===parseInt(t)){if(c(!1,"ppolicy-checkhibp-feedback"))return f=!1}else if(console.log("checkhibp: backend error: ",o),c(!1,"ppolicy-checkhibp-feedback"))return f=!1},error:function(e,t,o){var a;if(o&&console.log("checkhibp: frontend error: ",o),e&&(a=JSON.parse(e.responseText)),a&&a.error)return console.log("checkhibp: returned error: ",a)}})):c(!1,"ppolicy-checkhibp-feedback")&&(f=!1)),window.datas.ppolicy.allowedspechar){for(l=window.datas.ppolicy.allowedspechar.replace(/\s/g,""),l=l.replace(/<space>/g," "),a=!1,n=0,r=e.length;n<r;)x(e.charAt(n))||l.indexOf(e.charAt(n))<0&&(a=!0),n++;c(!1===a,"ppolicy-allowedspechar-feedback")&&(f=!1)}if(window.datas.ppolicy.minspechar>0&&window.datas.ppolicy.allowedspechar){for(d=0,l=window.datas.ppolicy.allowedspechar.replace(/\s/g,""),l=l.replace(/<space>/g," "),n=0;n<e.length;)l.indexOf(e.charAt(n))>=0&&d++,n++;c(d>=window.datas.ppolicy.minspechar,"ppolicy-minspechar-feedback")&&(f=!1)}if(window.datas.ppolicy.minspechar>0&&!window.datas.ppolicy.allowedspechar){for(d=0,n=0;n<e.length;)x(e.charAt(n))||d++,n++;c(d>=window.datas.ppolicy.minspechar,"ppolicy-minspechar-feedback")&&(f=!1)}f?($(".ppolicy").removeClass("border-danger").addClass("border-success"),null!=(u=$("#newpassword").get(0))&&u.setCustomValidity("")):($(".ppolicy").removeClass("border-success").addClass("border-danger"),null!=(p=$("#newpassword").get(0))&&p.setCustomValidity(g("PE28")))},null!=window.datas.ppolicy&&$("#newpassword").length&&(v(""),$("#newpassword").keyup(function(e){v(e.target.value)}),$("#newpassword").focusout(function(e){v(e.target.value,"focusout")})),H=function(e){var t;return e.target.checked?($("#newpassword").off("keyup"),null!=(t=$("#newpassword").get(0))?t.setCustomValidity(""):void 0):($("#newpassword").keyup(function(e){v(e.target.value)}),v(""))},y=function(){var e,t,o,a;return(null!=(e=$("#confirmpassword").get(0))?e.value:void 0)===(null!=(t=$("#newpassword").get(0))?t.value:void 0)?(null!=(o=$("#confirmpassword").get(0))&&o.setCustomValidity(""),!0):(null!=(a=$("#confirmpassword").get(0))&&a.setCustomValidity(g("PE34")),!1)},$("#newpassword").change(y),$("#confirmpassword").change(y),null!=window.datas.ppolicy&&$("#newpassword").length&&$("#reset").change(H),$(".localeDate").each(function(){var e;return e=new Date(1e3*$(this).attr("val")),$(this).text(e.toLocaleString())}),$(".oidcConsent").on("click",function(){return s($(this).attr("partner"))}),e.pingInterval&&e.pingInterval>0&&window.setTimeout(r,e.pingInterval),e.enablePasswordDisplay&&(b="",e.dontStorePassword?($(".toggle-password").on("mousedown touchstart",function(){return b=$(this).attr("id"),b=b.replace(/^toggle_/,""),console.log("Display",b),$(this).toggleClass("fa-eye fa-eye-slash"),$("input[name="+b+"]").attr("class","form-control")}),$(".toggle-password").on("mouseup touchend",function(){if($(this).toggleClass("fa-eye fa-eye-slash"),$("input[name="+b+"]").get(0).value)return $("input[name="+b+"]").attr("class","form-control key")})):($(".toggle-password").on("mousedown touchstart",function(){return b=$(this).attr("id"),b=b.replace(/^toggle_/,""),console.log("Display",b),$(this).toggleClass("fa-eye fa-eye-slash"),$("input[name="+b+"]").attr("type","text")}),$(".toggle-password").on("mouseup touchend",function(){return $(this).toggleClass("fa-eye fa-eye-slash"),$("input[name="+b+"]").attr("type","password")}))),$("#reset").change(function(){var e,t,o,a,n,r;return e=$(this).prop("checked"),console.log("Reset is checked",e),!0===e?($("#newpasswords").hide(),$("#newpassword").removeAttr("required"),$("#confirmpassword").removeAttr("required"),null!=(t=$("#confirmpassword").get(0))?t.setCustomValidity(""):void 0):($("#newpasswords").show(),$("#newpassword").attr("required",!0),$("#confirmpassword").attr("required",!0),(null!=(o=$("#confirmpassword").get(0))?o.value:void 0)===(null!=(a=$("#newpassword").get(0))?a.value:void 0)?null!=(n=$("#confirmpassword").get(0))?n.setCustomValidity(""):void 0:null!=(r=$("#confirmpassword").get(0))?r.setCustomValidity(g("PE34")):void 0)}),$("#passwordfield").on("input",function(){return $("#passwordfield").get(0).value&&e.dontStorePassword?$("#passwordfield").attr("class","form-control key"):$("#passwordfield").attr("class","form-control")}),$("#oldpassword").on("input",function(){return $("#oldpassword").get(0).value&&e.dontStorePassword?$("#oldpassword").attr("class","form-control key"):$("#oldpassword").attr("class","form-control")}),$("#newpassword").on("input",function(){return $("#newpassword").get(0).value&&e.dontStorePassword?$("#newpassword").attr("class","form-control key"):$("#newpassword").attr("class","form-control")}),$("#confirmpassword").on("input",function(){return $("#confirmpassword").get(0).value&&e.dontStorePassword?$("#confirmpassword").attr("class","form-control key"):$("#confirmpassword").attr("class","form-control")}),$(".clear-finduser-field").on("click",function(){return $(this).parent().find(":input").each(function(){return console.log("Clear search field ->",$(this).attr("name")),$(this).val("")})}),$("#closefinduserform").on("click",function(){return console.log("Clear modal"),$("#finduserForm").trigger("reset")}),$("#finduserbutton").on("click",function(e){var t;return e.preventDefault(),document.body.style.cursor="progress",t=$("#finduserForm").serialize(),console.log("Send findUser request with parameters",t),$.ajax({type:"POST",url:portal+"finduser",dataType:"json",data:t,success:function(e){var t;if(document.body.style.cursor="default",t=e.user,console.log("Suggested spoofId=",t),$("input[name=spoofId]").each(function(){return $(this).val(t)}),e.captcha&&$("#captcha").attr("src",e.captcha),e.token)return $("#finduserToken").val(e.token),$("#token").val(e.token)},error:function(e,t,o){var a;if(document.body.style.cursor="default",o&&console.log("Error",o),e&&(a=JSON.parse(e.responseText)),a&&a.error)return console.log("Returned error",a)}})}),$("#btn-back-to-top").on("click",function(){return console.log("Back to top"),document.body.scrollTop=0,document.documentElement.scrollTop=0}),$(window).on("scroll",function(){return e.scrollTop&&(document.body.scrollTop>Math.abs(e.scrollTop)||document.documentElement.scrollTop>Math.abs(e.scrollTop))?$("#btn-back-to-top").css("display","block"):$("#btn-back-to-top").css("display","none")}),$(document).trigger("portalLoaded"),!0})}).call(this);
//# sourceMappingURL=portal.min.js.map