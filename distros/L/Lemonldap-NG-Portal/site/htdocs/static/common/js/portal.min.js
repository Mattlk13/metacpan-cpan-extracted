!function(){"use strict";function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,a,s,i=[],c=!0,l=!1;try{if(a=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;c=!1}else for(;!(c=(o=a.call(n)).done)&&(i.push(o.value),i.length!==e);c=!0);}catch(t){l=!0,r=t}finally{try{if(!c&&null!=n.return&&(s=n.return(),Object(s)!==s))return}finally{if(l)throw r}}return i}}(t,e)||function(t,e){var n;if(t)return"string"==typeof t?o(t,e):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?o(t,e):void 0}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var w,e,m,h,y,v,b,k,t,x,d,C=[].indexOf,i={},n={},S=function(t,e){return T(t,n[t]=e),Object.values(n).every(function(t){return"good"===t||"info"===t})?null!=(t=$("#newpassword").get(0))&&t.setCustomValidity(""):null!=(e=$("#newpassword").get(0))&&e.setCustomValidity(P("PE28")),O()},T=function(t,e){switch($("#"+t).removeClass("fa-times fa-check fa-spinner fa-pulse fa-info-circle fa-question-circle text-danger text-success text-info text-secondary"),$("#"+t).attr("role","status"),e){case"good":return $("#"+t).addClass("fa-check text-success");case"bad":return $("#"+t).addClass("fa-times text-danger"),$("#"+t).attr("role","alert");case"unknown":return $("#"+t).addClass("fa-question-circle text-secondary");case"waiting":return $("#"+t).addClass("fa-spinner fa-pulse text-secondary");case"info":return $("#"+t).addClass("fa-info-circle text-info")}},O=function(){var t;return null!=(t=$("#newpassword").get(0))&&t.checkValidity()&&null!=(t=$("#confirmpassword").get(0))&&t.checkValidity()?$(".ppolicy").removeClass("border-danger").addClass("border-success"):$(".ppolicy").removeClass("border-success").addClass("border-danger")},j=function(a){return a?window.currentLanguage=a:a=window.currentLanguage,$.getJSON("".concat(window.staticPrefix,"languages/").concat(a,".json"),function(t){var e,n,o,r;for(e in i=t,n=window.datas.trOver.all)r=n[e],i[e]=r;if(window.datas.trOver[a])for(e in o=window.datas.trOver[a])r=o[e],i[e]=r;return $("[trspan]").each(function(){for(var t=$(this).attr("trspan").split(","),e=P(t.shift()),n=0,o=t.length;n<o;n++)r=t[n],e=e.replace(/%[sd]/,r);return $(this).html(e)}),$("[trmsg]").each(function(){if($(this).html(P("PE".concat($(this).attr("trmsg")))),P("PE".concat($(this).attr("trmsg"))).match(/_hide_/))return $(this).parent().hide()}),$("[trattribute]").each(function(){for(var t=$(this).attr("trattribute").trim().split(/\s+/),e=0,n=t.length;e<n;e++){var o=s(t[e].split(":"),2),r=o[0],o=o[1];r&&o&&$(this).attr(r,P(o))}return!0}),$("[trplaceholder]").each(function(){var t=P($(this).attr("trplaceholder"));return $(this).attr("placeholder",t),$(this).attr("aria-label",t)}),$("[localtime]").each(function(){var t=new Date(1e3*$(this).attr("localtime"));return $(this).text(t.toLocaleString())})})},P=function(t){return i[t]||t};window.translate=P,window.translatePage=j,h=function(){var o={};return $("script[type='application/init']").each(function(){var t,e,n;try{for(t in n=JSON.parse($(this).text()),e=[],n)e.push(o[t]=n[t]);return e}catch(t){return console.log("Parsing error",t),console.log("JSON",$(this).text())}}),console.log(o),o},m=function(t){t=RegExp("[?&]"+t+"=([^&]*)").exec(window.location.search);return t?decodeURIComponent(t[1].replace(/\+/g," ")):null},d="#appslist",x=function(){return t("_appsListOrder",$(d).sortable("toArray").join())},v=function(t){return e("_oidcConsents",t,function(){return $("[partner='".concat(t,"']")).hide()},function(t,e,n){return alert("".concat(e," ").concat(n))})},t=function(e,n,o,r){return $.ajax({type:"GET",url:"".concat(scriptname,"mysession/?gettoken"),dataType:"json",error:r,success:function(t){t={token:t.token};return t[e]=n,$.ajax({type:"PUT",url:"".concat(scriptname,"mysession/persistent"),dataType:"json",data:t,success:o,error:r})}})},e=function(e,n,o,r){return $.ajax({type:"GET",url:"".concat(scriptname,"mysession/?gettoken"),dataType:"json",error:r,success:function(t){return $.ajax({type:"DELETE",url:"".concat(scriptname,"mysession/persistent/").concat(e,"?sub=").concat(n,"&token=").concat(t.token),dataType:"json",success:o,error:r})}})},b=function(){var t,e,n,o,r,a,s,i,c,l,u=$(d);if(null==u||!w.appslistorder)return null;for(t=w.appslistorder.split(","),i=[],e=0,a=(o=u.sortable("toArray")).length;e<a;e++)i[l=o[e]]=l;for(r=0,s=t.length;r<s;r++)i[c=t[r]]&&(n=i[c],n=$(d+".ui-sortable").children("#"+n),c=$(d+".ui-sortable").children("#"+c),n.remove(),$(d+".ui-sortable").filter(":first").append(c));return 1},y=function(){return $.ajax({type:"POST",url:scriptname,data:{ping:1},dataType:"json",success:function(t){return null!=t.result&&1===t.result?setTimeout(y,w.pingInterval):location.reload(!0)},error:function(t,e,n){return location.reload(!0)}})},window.ping=y,k=function(t,e,n){var o=w.sameSite,r=w.cookieSecure,t="".concat(t,"=").concat(e,"; path=/; SameSite=").concat(o);return n&&((e=new Date).setTime(e.getTime()+864e5*n),t+="; expires=".concat(e.toUTCString())),r&&(t+="; Secure"),document.cookie=t},w={},$(window).on("load",function(){var t,e,n,o,r,a,s,i,c,l,u,d,p,f,g;w=h(),"datas"in window&&"choicetab"in window.datas&&(w.choicetab=window.datas.choicetab),window.datas=w,$("#appslist").sortable({axis:"y",cursor:"move",opacity:.5,revert:!0,items:"> div.category",update:x}),b(),$("div.message").fadeIn("slow"),$("input[name=timezone]").val(-(new Date).getTimezoneOffset()/60),l=$("#menu").tabs({active:0}),g=m("tab"),f=$('#menu a[href="#'+g+'"]').parent().index(),l.tabs("option","active",f=f<0?0:f),l=$("#authMenu").tabs({active:0}),f=$('#authMenu a[href="#'+g+'"]').parent().index(),l.tabs("option","active",f=f<0?0:f),w.choicetab&&l.tabs("option","active",$('#authMenu a[href="#'+w.choicetab+'"]').parent().index()),0===$("input[autofocus]").length&&$("input[type!=hidden]:first").focus(),w.newwindow&&$("#appslist a").attr("target","_blank"),$("p.removeOther").length&&(g=$("#form").attr("action"),f=$("#form").attr("method"),console.log("method=",f),r="",$("#form input[type=hidden]")&&(console.log("Parse hidden values"),$("#form input[type=hidden]").each(function(t){return console.log(" ->",$(this).attr("name"),$(this).val()),r+="&"+$(this).attr("name")+"="+$(this).val()})),l="",g&&(console.log("action=",g),-1!==g.indexOf("?")?g.substring(0,g.indexOf("?")):l=g+"?",l+=r,r=""),g=$("p.removeOther a").attr("href")+"&method="+f+r,l&&(g+="&url="+btoa(l)),$("p.removeOther a").attr("href",g)),window.location.search&&((u=m("llnglanguage"))&&console.log("Get lang from parameter"),1===(p=m("setCookieLang")))&&console.log("Set lang cookie"),s?C.call(window.availableLanguages,s)<0&&(s=window.datas.language,u||console.log("Lang not available -> Get lang from server")):(s=window.datas.language)&&!u&&console.log("Get lang from server"),u?(C.call(window.availableLanguages,u)<0&&(console.log("Lang not available -> Get lang from server"),u=window.language),console.log("Selected lang ->",u),p&&(console.log("Set cookie lang ->",u),k("llnglanguage",u,3650)),j(u)):(console.log("Selected lang ->",s),j(s)),i="";for(a=0,c=(d=window.availableLanguages).length;a<c;a++)t=d[a],i+='<img class="langicon" src="'.concat(window.staticPrefix,"common/").concat(t,'.png" title="').concat(t,'" alt="[').concat(t,']"> ');return $("#languages").html(i),$(".langicon").on("click",function(){return s=$(this).attr("title"),k("llnglanguage",s,3650),j(s)}),e=function(t,e){var n=jQuery.Event("checkpassword"),t={password:t,evType:e,setResult:S};return $(document).trigger(n,t)},n=function(){var t;return null!=(t=$("#confirmpassword").get(0))&&t.value&&(null!=(t=$("#confirmpassword").get(0))?t.value:void 0)===(null!=(t=$("#newpassword").get(0))?t.value:void 0)?(null!=(t=$("#confirmpassword").get(0))&&t.setCustomValidity(""),T("samepassword-feedback","good"),O(),!0):(null!=(t=$("#confirmpassword").get(0))&&t.setCustomValidity(P("PE34")),T("samepassword-feedback","bad"),O(),!1)},null!=window.datas.ppolicy&&$("#newpassword").length&&(e(""),n(),$("#confirmpassword").keyup(function(t){n()}),$("#newpassword").keyup(function(t){e(t.target.value),n()}),$("#newpassword").focusout(function(t){e(t.target.value,"focusout"),n()})),f=function(t){return t.target.checked?($("#newpassword").off("keyup"),null!=(t=$("#newpassword").get(0))?t.setCustomValidity(""):void 0):($("#newpassword").keyup(function(t){e(t.target.value)}),e(""))},$("#newpassword").change(n),$("#confirmpassword").change(n),null!=window.datas.ppolicy&&$("#newpassword").length&&$("#reset").change(f),$(".localeDate").each(function(){var t=new Date(1e3*$(this).attr("val"));return $(this).text(t.toLocaleString())}),$(".oidcConsent").on("click",function(){return v($(this).attr("partner"))}),w.pingInterval&&0<w.pingInterval&&window.setTimeout(y,w.pingInterval),w.enablePasswordDisplay&&(o="",w.dontStorePassword?($(".toggle-password").on("mousedown touchstart",function(){return o=(o=$(this).attr("id")).replace(/^toggle_/,""),console.log("Display",o),$(this).toggleClass("fa-eye fa-eye-slash"),$("input[name=".concat(o,"]")).attr("class","form-control")}),$(".toggle-password").on("mouseup touchend",function(){if($(this).toggleClass("fa-eye fa-eye-slash"),$("input[name=".concat(o,"]")).get(0).value)return $("input[name=".concat(o,"]")).attr("class","form-control key")})):($(".toggle-password").on("mousedown touchstart",function(){return o=(o=$(this).attr("id")).replace(/^toggle_/,""),console.log("Display",o),$(this).toggleClass("fa-eye fa-eye-slash"),$("input[name=".concat(o,"]")).attr("type","text")}),$(".toggle-password").on("mouseup touchend",function(){return $(this).toggleClass("fa-eye fa-eye-slash"),$("input[name=".concat(o,"]")).attr("type","password")}))),$("#reset").change(function(){var t=$(this).prop("checked");return console.log("Reset is checked",t),!0===t?($("#ppolicy").hide(),$("#newpasswords").hide(),$("#newpassword").removeAttr("required"),$("#confirmpassword").removeAttr("required"),null!=(t=$("#confirmpassword").get(0))?t.setCustomValidity(""):void 0):($("#ppolicy").show(),$("#newpasswords").show(),$("#newpassword").attr("required",!0),$("#confirmpassword").attr("required",!0),(null!=(t=$("#confirmpassword").get(0))?t.value:void 0)===(null!=(t=$("#newpassword").get(0))?t.value:void 0)?null!=(t=$("#confirmpassword").get(0))?t.setCustomValidity(""):void 0:null!=(t=$("#confirmpassword").get(0))?t.setCustomValidity(P("PE34")):void 0)}),$("#passwordfield").on("input",function(){return $("#passwordfield").get(0).value&&w.dontStorePassword?$("#passwordfield").attr("class","form-control key"):$("#passwordfield").attr("class","form-control")}),$("#oldpassword").on("input",function(){return $("#oldpassword").get(0).value&&w.dontStorePassword?$("#oldpassword").attr("class","form-control key"):$("#oldpassword").attr("class","form-control")}),$("#newpassword").on("input",function(){return $("#newpassword").get(0).value&&w.dontStorePassword?$("#newpassword").attr("class","form-control key"):$("#newpassword").attr("class","form-control")}),$("#confirmpassword").on("input",function(){return $("#confirmpassword").get(0).value&&w.dontStorePassword?$("#confirmpassword").attr("class","form-control key"):$("#confirmpassword").attr("class","form-control")}),$(".clear-finduser-field").on("click",function(){return $(this).parent().find(":input").each(function(){return console.log("Clear search field ->",$(this).attr("name")),$(this).val("")})}),$("#closefinduserform").on("click",function(){return console.log("Clear modal"),$("#finduserForm").trigger("reset")}),$("#finduserbutton").on("click",function(t){return t.preventDefault(),document.body.style.cursor="progress",t=$("#finduserForm").serialize(),console.log("Send findUser request with parameters",t),$.ajax({type:"POST",url:"".concat(scriptname,"finduser"),dataType:"json",data:t,success:function(t){var e;if(document.body.style.cursor="default",e=t.user,console.log("Suggested spoofId=",e),$("input[name=spoofId]").each(function(){return $(this).val(e)}),t.captcha&&$("#captcha").attr("src",t.captcha),t.token)return $("#finduserToken").val(t.token),$("#token").val(t.token)},error:function(t,e,n){var o;if(document.body.style.cursor="default",n&&console.log("Error",n),(o=t?JSON.parse(t.responseText):o)&&o.error)return console.log("Returned error",o)}})}),$("#btn-back-to-top").on("click",function(){return console.log("Back to top"),document.body.scrollTop=0,document.documentElement.scrollTop=0}),$(window).on("scroll",function(){return w.scrollTop&&(document.body.scrollTop>Math.abs(w.scrollTop)||document.documentElement.scrollTop>Math.abs(w.scrollTop))?$("#btn-back-to-top").css("display","block"):$("#btn-back-to-top").css("display","none")}),$(".btn-single-submit").on("click",function(t){return!0===$(this).data("data-submitted")?(t.preventDefault(),$(this).prop("disabled",!0)):$(this).data("data-submitted",!0)}),$('.category[name="'.concat(w.floatingCategory,'"]')).appendTo("#floating-menu").find("i").remove(),$('.category[name="'.concat(w.floatingCategory,'"]')).draggable(),$(document).trigger("portalLoaded"),!0})}();