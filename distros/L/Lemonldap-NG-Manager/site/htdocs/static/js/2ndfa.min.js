(function(){var S,o,f,g,e;e=function(e,t){return $("#msg").html(window.translate(e)),$("#color").removeClass("message-positive message-warning alert-success alert-warning"),$("#color").addClass("message-"+t),"positive"===t&&(t="success"),$("#color").addClass("alert-"+t)},g={_whatToTrace:[function(e,t){return"groupBy=substr("+e+",1)"},function(e,t){return e+"="+t+"*"}]},f={_whatToTrace:function(e,t,n,a){return console.log("overSchema => level",n,"over",a),1===n&&t.length>a?e+"="+t+"*&groupBy=substr("+e+","+(n+a+1)+")":null}},S={dateTitle:["_utime","_startTime","_updateTime"],sfaTitle:["_2fDevices"]},o={home:[]},angular.module("llngSessionsExplorer",["ui.tree","ui.bootstrap","llApp"]).controller("SessionsExplorerCtrl",["$scope","$translator","$location","$q","$http",function(k,t,e,n,i){var p,a,r,d;return k.links=links,k.menulinks=menulinks,k.staticPrefix=staticPrefix,k.scriptname=scriptname,k.formPrefix=formPrefix,k.availableLanguages=availableLanguages,k.waiting=!0,k.showM=!1,k.showT=!0,k.data=[],k.currentScope=null,k.currentSession=null,k.menu=o,k.searchString="",k.U2FCheck="1",k.TOTPCheck="1",k.UBKCheck="1",k.translateP=t.translateP,k.translate=t.translate,k.translateTitle=function(e){return t.translateField(e,"title")},d="persistent",k.menuClick=function(e){if(e.popup)window.open(e.popup);else switch(e.action||(e.action=e.title),typeof e.action){case"function":e.action(k.currentNode,k),k[e.action]();break;case"string":k[e.action]();break;default:console.log(typeof e.action)}return k.showM=!1},k.search2FA=function(e){return e&&(k.searchString=""),k.currentSession=null,k.data=[],k.updateTree2("",k.data,0,0)},k.delete2FA=function(e,t){var n,a,r;for(n=0,r=(a=document.querySelectorAll(".data-"+t)).length;n<r;n++)a[n].remove();return k.waiting=!0,i.delete(scriptname+"sfa/"+d+"/"+k.currentSession.id+"?type="+e+"&epoch="+t).then(function(e){return k.waiting=!1},function(e){return k.waiting=!1}),k.showT=!1},k.stoggle=function(e){var t;return 0===(t=e.$modelValue).nodes.length&&k.updateTree(t.value,t.nodes,t.level,t.over,t.query,t.count),e.toggle()},k.displaySession=function(e){var t,n;return n=function(o){var e,t,n,a,r,i,s,l,u,c,h,p,d,f,g,m,T,w,v,y,_;for(h in e=function(e){return e},function(e,t){var n,a,r,i;for(n in r=[],a=new RegExp(e),o)i=o[n],n.match(a)&&i&&(r.push({title:n,value:i}),delete o[n]);if(0<r.length)return m.push({title:t,nodes:r})},v=o._utime,u=o._session_id,o)(_=o[h])?("string"==typeof o&&_.match(/; /)&&(o[h]=_.split("; ")),"object"!=typeof o[h]&&("_password".match(new RegExp("\b"+h+"\b"))?o[h]="********":h.match(/^(_utime|_lastAuthnUTime|_lastSeen|notification)$/)?o[h]=k.localeDate(_):h.match(/^(_startTime|_updateTime)$/)&&(g=/^(\d{4})(\d{2})(\d{2})(\d{2})(\d{2})(\d{2})$/,n=(_=e(_)).match(g),o[h]=n[3]+"/"+n[2]+"/"+n[1]+" Ã  "+n[4]+":"+n[5]+":"+n[6]))):delete o[h];for(i in m=[],S){for(w=[],l=0,p=(r=S[i]).length;l<p;l++)if(a=r[l],o[a])if(o[a].toString().match(/"type":\s*"(?:TOTP|U2F|UBK)"/)){for(w.push({title:"type",value:"name",epoch:"date"}),c=0,d=(t=JSON.parse(o[a])).length;c<d;c++){for(h in T=t[c])_=T[h],"type"===h&&(y=_),"name"===h&&(f=_),"epoch"===h&&(s=_);w.push({title:y,value:f,epoch:s})}delete o[a]}else o[a].toString().match(/\w+/)&&w.push({title:a,value:o[a]}),delete o[a];else delete o[a];0<w.length&&m.push({title:"__"+i+"__",nodes:w})}return{_utime:v,id:u,nodes:m}},t=(k.currentScope=e).$modelValue.session,i.get(scriptname+"sfa/"+d+"/"+t).then(function(e){return k.currentSession=n(e.data)}),k.showT=!1},k.localeDate=function(e){return new Date(1e3*e).toLocaleString()},k.getLanguage=function(e){return k.lang=e,k.form="white",k.init(),k.showM=!1},r=function(e,t,n){var a;return null!==(a=t.match(/#!?\/(\w+)/))&&!a[1].match(/^(persistent)$/)||(k.type="_session_uid"),k.init()},k.$on("$locationChangeSuccess",r),p=0,k.updateTree=function(o,s,l,u,e,t){var c,h,n;return k.waiting=!0,h=g[k.type]?g[k.type]:g._whatToTrace,c=h[l](k.type,o,e),25<t&&f[k.type]&&(n=f[k.type](k.type,o,l,u,e))?(u++,c=n,l-=1):u=0,i.get(scriptname+"sfa/"+d+"?"+c+"&U2FCheck="+k.U2FCheck+"&TOTPCheck="+k.TOTPCheck+"&UBKCheck="+k.UBKCheck).then(function(e){var t,n,a,r,i;if((t=e.data).result){for(n=0,a=(i=t.values).length;n<a;n++)r=i[n],p++,r.id="node"+p,l<h.length-1&&(r.nodes=[],r.level=l+1,r.query=c,r.over=u),s.push(r);""===o&&(k.total=t.total)}return k.waiting=!1},function(e){return k.waiting=!1})},k.updateTree2=function(o,s,l,u,e,t){var c,h,n;return k.waiting=!0,h=g[k.type]?g[k.type]:"_updateTime"===k.type?g._startTime:g._whatToTrace,c=h[l](k.type,o,e),25<t&&f[k.type]&&(n=f[k.type](k.type,o,l,u,e))?(u++,c=n,l-=1):u=0,i.get(scriptname+"sfa/"+d+"?_session_uid="+k.searchString+"*&groupBy=substr(_session_uid,"+k.searchString.length+")&U2FCheck="+k.U2FCheck+"&TOTPCheck="+k.TOTPCheck+"&UBKCheck="+k.UBKCheck).then(function(e){var t,n,a,r,i;if((t=e.data).result){for(n=0,a=(i=t.values).length;n<a;n++)r=i[n],p++,r.id="node"+p,l<h.length-1&&(r.nodes=[],r.level=l+1,r.query=c,r.over=u),s.push(r);""===o&&(k.total=t.total)}return k.waiting=!1},function(e){return k.waiting=!1})},k.init=function(){return k.waiting=!0,k.data=[],n.all([t.init(k.lang),k.updateTree("",k.data,0,0)]).then(function(){return k.waiting=!1},function(e){return k.waiting=!1}),k.activeModule="2ndFA",k.myStyle={color:"#ffb84d"}},a=e.path().match(/^\/(\w+)/),k.type=a?a[1]:"_whatToTrace"}])}).call(this);