!function(){"use strict";var e=angular.module("llApp",["ngAria"]);e.provider("$translator",function(){var e,t,n,r,a,i,o,s,l,u,c,g={};if(decodeURIComponent(document.cookie).match(/llnglanguage=(\w+)/))g.lang=RegExp.$1;else if(navigator){for(r=[],a=[],l=[navigator.language],t=0,i=(l=navigator.languages?navigator.languages:l).length;t<i;t++)for(s=l[t],console.log("Navigator lang",s),n=0,o=(c=window.availableLanguages).length;n<o;n++)e=c[n],console.log(" Available lang",e),u=new RegExp("^"+e+"-?"),s.match(u)?(console.log("  Matching lang =",e),r.push(e)):e.substring(0,1)===s.substring(0,1)&&a.push(e);g.lang=r[0]||a[0]||"en"}else g.lang="en";return console.log("Selected lang ->",g.lang),g.deferredTr=[],g.translationFields={},g.translate=function(e){return e=g.translationFields[e]?g.translationFields[e]:e},g.translateField=function(e,t){return g.translate(e[t])},g.translateP=function(e){return e=e&&g.translationFields.portal?e.replace(/__(\w+)__/g,function(e,t){return g.translate(t)}):e},this.$get=["$q","$http",function(t,n){return g.last="",g.init=function(e){var i;return e=e||g.lang,(i=new Date).setTime(i.getTime()+2592e6),document.cookie=`llnglanguage=${e}; expires=${i.toUTCString()}; path=/`,i=t.defer(),g.last!==e?(g.last=e,n.get(window.staticPrefix+`languages/${e}.json`).then(function(e){var t,n,r,a;for(g.translationFields=e.data,n=0,r=(a=g.deferredTr).length;n<r;n++)(t=a[n]).e[t.f](g.translationFields[t.m]);return g.deferredTr=[],i.resolve("Translation files loaded")},function(e){return i.reject("")})):i.resolve("No change"),i.promise},g}],this}),e.directive("trspan",["$translator",function(r){return{restrict:"A",replace:!1,transclude:!0,scope:{trspan:"@"},link:function(e,t,n){return r.translationFields.portal?n.trspan=r.translate(n.trspan):r.deferredTr.push({e:t,f:"text",m:n.trspan}),t.text(n.trspan)},template:""}}]),e.provider("$htmlParams",function(){return this.$get=function(){var n={};return{set:function(e,t){return n[e]=t},menu:function(){return n.menu},params:function(){return n.params}}},this}),e.directive("script",["$htmlParams",function(n){return{restrict:"E",terminal:!0,compile:function(e,t){if(t.type&&(t=t.type.match(/text\/(menu|parameters)/)))try{return n.set(t[1],JSON.parse(e[0].text))}catch(e){console.log("Parsing error:",e)}}}}]),e.controller("ModalInstanceCtrl",["$scope","$uibModalInstance","elem","set","init",function(a,e,t,n,r){var i,o;return a.elem=t,a.set=n,a.result=r,a.staticPrefix=window.staticPrefix,i=t("currentNode"),a.translateP=t("translateP"),i&&(o=i.data,a.currentNode=i),a.ok=function(){return n("result",a.result),e.close(!0)},a.cancel=function(){return i&&(a.currentNode.data=o),e.dismiss("cancel")},a.inSelect=function(e){for(var t=a.currentNode.select,n=0,r=t.length;n<r;n++)if(t[n].k===e)return!0;return!1}}]),e.directive("onReadFile",["$parse",function(a){return{restrict:"A",scope:!1,link:function(n,e,t){var r=a(t.onReadFile);return e.on("change",function(e){var t=new FileReader;return t.onload=function(e){return n.$apply(function(){return r(n,{$fileContent:e.target.result})})},t.readAsText((e.srcElement||e.target).files[0])})}}}]),e.directive("resizer",["$document",function(i){var o=null,s=null;return function(e,t,n){var r,a;return t.on("mousedown",function(e){return"vertical"===n.resizer?s=$(n.resizerRight).width()+$(n.resizerLeft).width():o=$(n.resizerTop).height()+$(n.resizerBottom).height(),e.preventDefault(),i.on("mousemove",r),i.on("mouseup",a)}),r=function(e){var t;return"vertical"===n.resizer?(t=e.pageX,n.resizerMax&&t>n.resizerMax&&(t=parseInt(n.resizerMax)),$(n.resizerLeft).css({width:t+"px"}),$(n.resizerRight).css({width:s-t+"px"})):(t=e.pageY-$("#navbar").height(),$(n.resizerTop).css({height:t+"px"}),$(n.resizerBottom).css({height:o-t+"px"}))},a=function(){return i.unbind("mousemove",r),i.unbind("mouseup",a)}}}]),e.factory("$lmhttp",["$q","$location",function(t,e){return{responseError:function(e){return 401===e.status&&window.portal?window.location=window.portal+"?url="+window.btoa(window.location).replace(/\//,"_"):t.reject(e)}}}]),e.config(["$httpProvider",function(e){return e.interceptors.push("$lmhttp")}])}();