
constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538040_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538040_14534_0 bar baz
dropping temporary database test_mysqldiff-temp-1466538040_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS baz;
]
  table def [CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'baz'
line: [firstname char(16) DEFAULT NULL]
got field def 'firstname': char(16) DEFAULT NULL
line: [surname char(16) DEFAULT NULL]
got field def 'surname': char(16) DEFAULT NULL
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538041_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538041_14534_0 bar baz
dropping temporary database test_mysqldiff-temp-1466538041_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY name (name,age)]
got unique index key 'name': (name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS baz;
]
  table def [CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'baz'
line: [firstname char(16) DEFAULT NULL]
got field def 'firstname': char(16) DEFAULT NULL
line: [surname char(16) DEFAULT NULL]
got field def 'surname': char(16) DEFAULT NULL
line: [UNIQUE KEY firstname (firstname,surname)]
got unique index key 'firstname': (firstname,surname)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
index 'name' added
table 1 baz = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'fields' => {
                               'firstname' => 'char(16) DEFAULT NULL',
                               'surname' => 'char(16) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'name' => 'baz',
                 'lines' => [
                              'CREATE TABLE baz (
',
                              '  firstname char(16) DEFAULT NULL,
',
                              '  surname char(16) DEFAULT NULL
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ]
               }, 'MySQL::Diff::Table' );

looking at tables called 'baz'
comparing tables called 'baz'
table1 had field 'firstname'
table1 had field 'surname'
index 'firstname' added
table 2 bar = $VAR1 = bless( {
                 'unique' => {
                               'name' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY name (name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
',
                 'indices' => {
                                'name' => 'name,age'
                              }
               }, 'MySQL::Diff::Table' );

table 2 baz = $VAR1 = bless( {
                 'unique' => {
                               'firstname' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'name' => 'baz',
                 'lines' => [
                              'CREATE TABLE baz (
',
                              '  firstname char(16) DEFAULT NULL,
',
                              '  surname char(16) DEFAULT NULL,
',
                              '  UNIQUE KEY firstname (firstname,surname)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'firstname' => 'char(16) DEFAULT NULL',
                               'surname' => 'char(16) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'firstname' => 'firstname,surname'
                              }
               }, 'MySQL::Diff::Table' );

ALTER TABLE bar ADD UNIQUE name (name,age);
ALTER TABLE baz ADD UNIQUE firstname (firstname,surname);


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538041_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538041_14534_0 bar baz
dropping temporary database test_mysqldiff-temp-1466538041_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY name (name,age)]
got unique index key 'name': (name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS baz;
]
  table def [CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'baz'
line: [firstname char(16) DEFAULT NULL]
got field def 'firstname': char(16) DEFAULT NULL
line: [surname char(16) DEFAULT NULL]
got field def 'surname': char(16) DEFAULT NULL
line: [UNIQUE KEY firstname (firstname,surname)]
got unique index key 'firstname': (firstname,surname)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'unique' => {
                               'name' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY name (name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
',
                 'indices' => {
                                'name' => 'name,age'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
table1 had index 'name'
table 1 baz = $VAR1 = bless( {
                 'unique' => {
                               'firstname' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'name' => 'baz',
                 'lines' => [
                              'CREATE TABLE baz (
',
                              '  firstname char(16) DEFAULT NULL,
',
                              '  surname char(16) DEFAULT NULL,
',
                              '  UNIQUE KEY firstname (firstname,surname)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'firstname' => 'char(16) DEFAULT NULL',
                               'surname' => 'char(16) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'firstname' => 'firstname,surname'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'baz'
comparing tables called 'baz'
table1 had field 'firstname'
table1 had field 'surname'
table1 had index 'firstname'
table 2 bar = $VAR1 = bless( {
                 'unique' => {
                               'name' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'fulltext' => {},
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY name (name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
',
                 'indices' => {
                                'name' => 'name,age'
                              }
               }, 'MySQL::Diff::Table' );

table 2 baz = $VAR1 = bless( {
                 'unique' => {
                               'firstname' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'fulltext' => {},
                 'name' => 'baz',
                 'lines' => [
                              'CREATE TABLE baz (
',
                              '  firstname char(16) DEFAULT NULL,
',
                              '  surname char(16) DEFAULT NULL,
',
                              '  UNIQUE KEY firstname (firstname,surname)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'firstname' => 'char(16) DEFAULT NULL',
                               'surname' => 'char(16) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'firstname' => 'firstname,surname'
                              }
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538041_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538041_14534_0 
dropping temporary database test_mysqldiff-temp-1466538041_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY name (name,age)]
got unique index key 'name': (name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538041_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538041_14534_0 
dropping temporary database test_mysqldiff-temp-1466538041_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'unique' => {
                               'name' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY name (name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'name' => 'name,age'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
table1 had index 'name'
index 'name' removed
table 2 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

ALTER TABLE bar DROP INDEX name; # was UNIQUE (name,age)


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538041_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538041_14534_0 
dropping temporary database test_mysqldiff-temp-1466538041_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
table 2 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538041_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538041_14534_0 
dropping temporary database test_mysqldiff-temp-1466538041_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538042_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538042_14534_0 
dropping temporary database test_mysqldiff-temp-1466538042_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
table 'bar' dropped
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
field 'field' added
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

ALTER TABLE foo ADD COLUMN field blob;


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538042_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538042_14534_0 
dropping temporary database test_mysqldiff-temp-1466538042_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
table 'bar' dropped
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538042_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538042_14534_0 
dropping temporary database test_mysqldiff-temp-1466538042_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538042_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538042_14534_0 
dropping temporary database test_mysqldiff-temp-1466538042_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY id (id,name,age)]
got unique index key 'id': (id,name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
index 'id' added
table 2 bar = $VAR1 = bless( {
                 'unique' => {
                               'id' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY id (id,name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'id' => 'id,name,age'
                              }
               }, 'MySQL::Diff::Table' );

ALTER TABLE bar ADD UNIQUE id (id,name,age);


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538042_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538042_14534_0 
dropping temporary database test_mysqldiff-temp-1466538042_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY id (id,name,age)]
got unique index key 'id': (id,name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'unique' => {
                               'id' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY id (id,name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'id' => 'id,name,age'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
table1 had index 'id'
table 2 bar = $VAR1 = bless( {
                 'unique' => {
                               'id' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'fulltext' => {},
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY id (id,name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'id' => 'id,name,age'
                              }
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538042_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538042_14534_0 
dropping temporary database test_mysqldiff-temp-1466538042_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id,foreign_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id,foreign_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field tinyblob]
got field def 'field': tinyblob
line: [PRIMARY KEY (id,foreign_id)]
got primary key (id,foreign_id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538042_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538042_14534_0 
dropping temporary database test_mysqldiff-temp-1466538042_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field tinyblob]
got field def 'field': tinyblob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id,foreign_id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'foreign_id' => 1,
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field tinyblob,
',
                              '  PRIMARY KEY (id,foreign_id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'tinyblob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id,foreign_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
primary key changed
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field tinyblob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'tinyblob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {}
               }, 'MySQL::Diff::Table' );

ALTER TABLE foo ADD INDEX (id); # auto columns must always be indexed
ALTER TABLE foo DROP PRIMARY KEY; # was (id,foreign_id)
ALTER TABLE foo ADD PRIMARY KEY (id);
ALTER TABLE foo DROP INDEX id;


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538042_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538042_14534_0 
dropping temporary database test_mysqldiff-temp-1466538042_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field tinyblob]
got field def 'field': tinyblob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field tinyblob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'tinyblob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field tinyblob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'tinyblob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {}
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538043_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538043_14534_0 
dropping temporary database test_mysqldiff-temp-1466538043_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538043_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538043_14534_0 
dropping temporary database test_mysqldiff-temp-1466538043_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
field 'field' removed
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

ALTER TABLE foo DROP COLUMN field; # was blob


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538043_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538043_14534_0 
dropping temporary database test_mysqldiff-temp-1466538043_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538043_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538043_14534_0 
dropping temporary database test_mysqldiff-temp-1466538043_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538043_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538043_14534_0 
dropping temporary database test_mysqldiff-temp-1466538043_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
table 'bar' dropped
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
field 'field' added
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

ALTER TABLE foo ADD COLUMN field blob;


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538044_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538044_14534_0 
dropping temporary database test_mysqldiff-temp-1466538044_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
table 'bar' dropped
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538044_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538044_14534_0 
dropping temporary database test_mysqldiff-temp-1466538044_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY name (name,age)]
got unique index key 'name': (name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538044_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538044_14534_0 
dropping temporary database test_mysqldiff-temp-1466538044_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY id (id,name,age)]
got unique index key 'id': (id,name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'unique' => {
                               'name' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY name (name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'name' => 'name,age'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
table1 had index 'name'
index 'name' removed
index 'id' added
table 2 bar = $VAR1 = bless( {
                 'unique' => {
                               'id' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY id (id,name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'id' => 'id,name,age'
                              }
               }, 'MySQL::Diff::Table' );

ALTER TABLE bar DROP INDEX name; # was UNIQUE (name,age)
ALTER TABLE bar ADD UNIQUE id (id,name,age);


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538044_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538044_14534_0 
dropping temporary database test_mysqldiff-temp-1466538044_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY id (id,name,age)]
got unique index key 'id': (id,name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'unique' => {
                               'id' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY id (id,name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'id' => 'id,name,age'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
table1 had index 'id'
table 2 bar = $VAR1 = bless( {
                 'unique' => {
                               'id' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'fulltext' => {},
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY id (id,name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'id' => 'id,name,age'
                              }
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538044_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538044_14534_0 
dropping temporary database test_mysqldiff-temp-1466538044_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS baz;
]
  table def [CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'baz'
line: [firstname char(16) DEFAULT NULL]
got field def 'firstname': char(16) DEFAULT NULL
line: [surname char(16) DEFAULT NULL]
got field def 'surname': char(16) DEFAULT NULL
line: [KEY firstname (firstname,surname)]
got index key 'firstname': (firstname,surname)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538044_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538044_14534_0 
dropping temporary database test_mysqldiff-temp-1466538044_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS baz;
]
  table def [CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'baz'
line: [firstname char(16) DEFAULT NULL]
got field def 'firstname': char(16) DEFAULT NULL
line: [surname char(16) DEFAULT NULL]
got field def 'surname': char(16) DEFAULT NULL
line: [UNIQUE KEY firstname (firstname,surname)]
got unique index key 'firstname': (firstname,surname)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 baz = $VAR1 = bless( {
                 'unique' => {},
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'name' => 'baz',
                 'lines' => [
                              'CREATE TABLE baz (
',
                              '  firstname char(16) DEFAULT NULL,
',
                              '  surname char(16) DEFAULT NULL,
',
                              '  KEY firstname (firstname,surname)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'firstname' => 'char(16) DEFAULT NULL',
                               'surname' => 'char(16) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'firstname' => 'firstname,surname'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'baz'
comparing tables called 'baz'
table1 had field 'firstname'
table1 had field 'surname'
table1 had index 'firstname'
index 'firstname' changed
table 2 baz = $VAR1 = bless( {
                 'unique' => {
                               'firstname' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'name' => 'baz',
                 'lines' => [
                              'CREATE TABLE baz (
',
                              '  firstname char(16) DEFAULT NULL,
',
                              '  surname char(16) DEFAULT NULL,
',
                              '  UNIQUE KEY firstname (firstname,surname)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'firstname' => 'char(16) DEFAULT NULL',
                               'surname' => 'char(16) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'firstname' => 'firstname,surname'
                              }
               }, 'MySQL::Diff::Table' );

ALTER TABLE baz DROP INDEX firstname; # was INDEX (firstname,surname)
ALTER TABLE baz ADD UNIQUE firstname (firstname,surname);


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538044_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538044_14534_0 
dropping temporary database test_mysqldiff-temp-1466538044_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS baz;
]
  table def [CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'baz'
line: [firstname char(16) DEFAULT NULL]
got field def 'firstname': char(16) DEFAULT NULL
line: [surname char(16) DEFAULT NULL]
got field def 'surname': char(16) DEFAULT NULL
line: [UNIQUE KEY firstname (firstname,surname)]
got unique index key 'firstname': (firstname,surname)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 baz = $VAR1 = bless( {
                 'unique' => {
                               'firstname' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'name' => 'baz',
                 'lines' => [
                              'CREATE TABLE baz (
',
                              '  firstname char(16) DEFAULT NULL,
',
                              '  surname char(16) DEFAULT NULL,
',
                              '  UNIQUE KEY firstname (firstname,surname)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'firstname' => 'char(16) DEFAULT NULL',
                               'surname' => 'char(16) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'firstname' => 'firstname,surname'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'baz'
comparing tables called 'baz'
table1 had field 'firstname'
table1 had field 'surname'
table1 had index 'firstname'
table 2 baz = $VAR1 = bless( {
                 'unique' => {
                               'firstname' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'fulltext' => {},
                 'name' => 'baz',
                 'lines' => [
                              'CREATE TABLE baz (
',
                              '  firstname char(16) DEFAULT NULL,
',
                              '  surname char(16) DEFAULT NULL,
',
                              '  UNIQUE KEY firstname (firstname,surname)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'firstname' => 'char(16) DEFAULT NULL',
                               'surname' => 'char(16) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'firstname' => 'firstname,surname'
                              }
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538045_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538045_14534_0 
dropping temporary database test_mysqldiff-temp-1466538045_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538045_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538045_14534_0 
dropping temporary database test_mysqldiff-temp-1466538045_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY name (name,age)]
got unique index key 'name': (name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
index 'name' added
table 2 bar = $VAR1 = bless( {
                 'unique' => {
                               'name' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY name (name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'name' => 'name,age'
                              }
               }, 'MySQL::Diff::Table' );

ALTER TABLE bar ADD UNIQUE name (name,age);


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538045_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538045_14534_0 
dropping temporary database test_mysqldiff-temp-1466538045_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY name (name,age)]
got unique index key 'name': (name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'unique' => {
                               'name' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY name (name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'name' => 'name,age'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
table1 had index 'name'
table 2 bar = $VAR1 = bless( {
                 'unique' => {
                               'name' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'fulltext' => {},
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY name (name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'name' => 'name,age'
                              }
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538045_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538045_14534_0 
dropping temporary database test_mysqldiff-temp-1466538045_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538045_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538045_14534_0 
dropping temporary database test_mysqldiff-temp-1466538045_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
field 'field' added
table 2 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
               }, 'MySQL::Diff::Table' );

table 'bar' added
table 'bar' added 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

ALTER TABLE foo ADD COLUMN field blob;
CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;



constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538045_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538045_14534_0 
dropping temporary database test_mysqldiff-temp-1466538045_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
table 2 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
               }, 'MySQL::Diff::Table' );

table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538046_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538046_14534_0 
dropping temporary database test_mysqldiff-temp-1466538046_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY id (id,name,age)]
got unique index key 'id': (id,name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538046_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538046_14534_0 
dropping temporary database test_mysqldiff-temp-1466538046_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY name (name,age)]
got unique index key 'name': (name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'unique' => {
                               'id' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY id (id,name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'id' => 'id,name,age'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
table1 had index 'id'
index 'id' removed
index 'name' added
table 2 bar = $VAR1 = bless( {
                 'unique' => {
                               'name' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY name (name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'name' => 'name,age'
                              }
               }, 'MySQL::Diff::Table' );

ALTER TABLE bar DROP INDEX id; # was UNIQUE (id,name,age)
ALTER TABLE bar ADD UNIQUE name (name,age);


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538046_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538046_14534_0 
dropping temporary database test_mysqldiff-temp-1466538046_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY name (name,age)]
got unique index key 'name': (name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'unique' => {
                               'name' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY name (name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'name' => 'name,age'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
table1 had index 'name'
table 2 bar = $VAR1 = bless( {
                 'unique' => {
                               'name' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'fulltext' => {},
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY name (name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY name (name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'name' => 'name,age'
                              }
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538046_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538046_14534_0 
dropping temporary database test_mysqldiff-temp-1466538046_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS baz;
]
  table def [CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'baz'
line: [firstname char(16) DEFAULT NULL]
got field def 'firstname': char(16) DEFAULT NULL
line: [surname char(16) DEFAULT NULL]
got field def 'surname': char(16) DEFAULT NULL
line: [UNIQUE KEY firstname (firstname,surname)]
got unique index key 'firstname': (firstname,surname)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538046_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538046_14534_0 
dropping temporary database test_mysqldiff-temp-1466538046_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS baz;
]
  table def [CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'baz'
line: [firstname char(16) DEFAULT NULL]
got field def 'firstname': char(16) DEFAULT NULL
line: [surname char(16) DEFAULT NULL]
got field def 'surname': char(16) DEFAULT NULL
line: [KEY firstname (firstname,surname)]
got index key 'firstname': (firstname,surname)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 baz = $VAR1 = bless( {
                 'unique' => {
                               'firstname' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'name' => 'baz',
                 'lines' => [
                              'CREATE TABLE baz (
',
                              '  firstname char(16) DEFAULT NULL,
',
                              '  surname char(16) DEFAULT NULL,
',
                              '  UNIQUE KEY firstname (firstname,surname)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'firstname' => 'char(16) DEFAULT NULL',
                               'surname' => 'char(16) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  UNIQUE KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'firstname' => 'firstname,surname'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'baz'
comparing tables called 'baz'
table1 had field 'firstname'
table1 had field 'surname'
table1 had index 'firstname'
index 'firstname' changed
table 2 baz = $VAR1 = bless( {
                 'unique' => {},
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'fulltext' => {},
                 'name' => 'baz',
                 'lines' => [
                              'CREATE TABLE baz (
',
                              '  firstname char(16) DEFAULT NULL,
',
                              '  surname char(16) DEFAULT NULL,
',
                              '  KEY firstname (firstname,surname)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'firstname' => 'char(16) DEFAULT NULL',
                               'surname' => 'char(16) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'firstname' => 'firstname,surname'
                              }
               }, 'MySQL::Diff::Table' );

ALTER TABLE baz DROP INDEX firstname; # was UNIQUE (firstname,surname)
ALTER TABLE baz ADD INDEX firstname (firstname,surname);


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538046_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538046_14534_0 
dropping temporary database test_mysqldiff-temp-1466538046_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS baz;
]
  table def [CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'baz'
line: [firstname char(16) DEFAULT NULL]
got field def 'firstname': char(16) DEFAULT NULL
line: [surname char(16) DEFAULT NULL]
got field def 'surname': char(16) DEFAULT NULL
line: [KEY firstname (firstname,surname)]
got index key 'firstname': (firstname,surname)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 baz = $VAR1 = bless( {
                 'unique' => {},
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'name' => 'baz',
                 'lines' => [
                              'CREATE TABLE baz (
',
                              '  firstname char(16) DEFAULT NULL,
',
                              '  surname char(16) DEFAULT NULL,
',
                              '  KEY firstname (firstname,surname)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'firstname' => 'char(16) DEFAULT NULL',
                               'surname' => 'char(16) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'firstname' => 'firstname,surname'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'baz'
comparing tables called 'baz'
table1 had field 'firstname'
table1 had field 'surname'
table1 had index 'firstname'
table 2 baz = $VAR1 = bless( {
                 'unique' => {},
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'fulltext' => {},
                 'name' => 'baz',
                 'lines' => [
                              'CREATE TABLE baz (
',
                              '  firstname char(16) DEFAULT NULL,
',
                              '  surname char(16) DEFAULT NULL,
',
                              '  KEY firstname (firstname,surname)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'firstname' => 'char(16) DEFAULT NULL',
                               'surname' => 'char(16) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE baz (
  firstname char(16) DEFAULT NULL,
  surname char(16) DEFAULT NULL,
  KEY firstname (firstname,surname)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'firstname' => 'firstname,surname'
                              }
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538046_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538046_14534_0 
dropping temporary database test_mysqldiff-temp-1466538046_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field tinyblob]
got field def 'field': tinyblob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538046_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538046_14534_0 
dropping temporary database test_mysqldiff-temp-1466538046_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id,foreign_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id,foreign_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field tinyblob]
got field def 'field': tinyblob
line: [PRIMARY KEY (id,foreign_id)]
got primary key (id,foreign_id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field tinyblob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'tinyblob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
primary key changed
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id,foreign_id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'foreign_id' => 1,
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field tinyblob,
',
                              '  PRIMARY KEY (id,foreign_id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'tinyblob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id,foreign_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {}
               }, 'MySQL::Diff::Table' );

ALTER TABLE foo ADD INDEX (id); # auto columns must always be indexed
ALTER TABLE foo DROP PRIMARY KEY; # was (id)
ALTER TABLE foo ADD PRIMARY KEY (id,foreign_id);
ALTER TABLE foo DROP INDEX id;


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538046_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538046_14534_0 
dropping temporary database test_mysqldiff-temp-1466538046_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id,foreign_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id,foreign_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field tinyblob]
got field def 'field': tinyblob
line: [PRIMARY KEY (id,foreign_id)]
got primary key (id,foreign_id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id,foreign_id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'foreign_id' => 1,
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field tinyblob,
',
                              '  PRIMARY KEY (id,foreign_id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'tinyblob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id,foreign_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id,foreign_id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'foreign_id' => 1,
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field tinyblob,
',
                              '  PRIMARY KEY (id,foreign_id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'tinyblob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id,foreign_id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {}
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538047_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538047_14534_0 
dropping temporary database test_mysqldiff-temp-1466538047_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538047_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538047_14534_0 
dropping temporary database test_mysqldiff-temp-1466538047_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field tinyblob]
got field def 'field': tinyblob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
field 'field' changed
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field tinyblob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'tinyblob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

ALTER TABLE foo CHANGE COLUMN field field tinyblob; # was blob


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538047_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538047_14534_0 
dropping temporary database test_mysqldiff-temp-1466538047_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field tinyblob]
got field def 'field': tinyblob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field tinyblob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'tinyblob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field tinyblob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'tinyblob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field tinyblob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538047_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538047_14534_0 
dropping temporary database test_mysqldiff-temp-1466538047_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538047_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538047_14534_0 
dropping temporary database test_mysqldiff-temp-1466538047_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
field 'field' removed
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

ALTER TABLE foo DROP COLUMN field;


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538047_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538047_14534_0 
dropping temporary database test_mysqldiff-temp-1466538047_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538047_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538047_14534_0 
dropping temporary database test_mysqldiff-temp-1466538047_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538047_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538047_14534_0 
dropping temporary database test_mysqldiff-temp-1466538047_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
field 'field' added
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

ALTER TABLE foo ADD COLUMN field blob;


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538047_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538047_14534_0 
dropping temporary database test_mysqldiff-temp-1466538047_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538048_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538048_14534_0 
dropping temporary database test_mysqldiff-temp-1466538048_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [UNIQUE KEY id (id,name,age)]
got unique index key 'id': (id,name,age)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538048_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538048_14534_0 
dropping temporary database test_mysqldiff-temp-1466538048_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'unique' => {
                               'id' => 1
                             },
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id),
',
                              '  UNIQUE KEY id (id,name,age)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id),
  UNIQUE KEY id (id,name,age)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {
                                'id' => 'id,name,age'
                              }
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
table1 had index 'id'
index 'id' removed
table 2 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {}
               }, 'MySQL::Diff::Table' );

ALTER TABLE bar DROP INDEX id; # was UNIQUE (id,name,age)


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538048_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538048_14534_0 
dropping temporary database test_mysqldiff-temp-1466538048_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
comparing tables called 'bar'
table1 had field 'ctime'
table1 had field 'utime'
table1 had field 'name'
table1 had field 'id'
table1 had field 'age'
table 2 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


',
                 'indices' => {}
               }, 'MySQL::Diff::Table' );



constructing new MySQL::Diff

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538048_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538048_14534_0 
dropping temporary database test_mysqldiff-temp-1466538048_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS bar;
]
  table def [CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
got table name 'bar'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [ctime datetime DEFAULT NULL]
got field def 'ctime': datetime DEFAULT NULL
line: [utime datetime DEFAULT NULL]
got field def 'utime': datetime DEFAULT NULL
line: [name char(16) DEFAULT NULL]
got field def 'name': char(16) DEFAULT NULL
line: [age int(11) DEFAULT NULL]
got field def 'age': int(11) DEFAULT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db2
creating temporary database test_mysqldiff-temp-1466538048_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538048_14534_0 
dropping temporary database test_mysqldiff-temp-1466538048_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 bar = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'bar',
                 'lines' => [
                              'CREATE TABLE bar (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  ctime datetime DEFAULT NULL,
',
                              '  utime datetime DEFAULT NULL,
',
                              '  name char(16) DEFAULT NULL,
',
                              '  age int(11) DEFAULT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'ctime' => 'datetime DEFAULT NULL',
                               'utime' => 'datetime DEFAULT NULL',
                               'name' => 'char(16) DEFAULT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'age' => 'int(11) DEFAULT NULL'
                             },
                 'def' => 'CREATE TABLE bar (
  id int(11) NOT NULL AUTO_INCREMENT,
  ctime datetime DEFAULT NULL,
  utime datetime DEFAULT NULL,
  name char(16) DEFAULT NULL,
  age int(11) DEFAULT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
               }, 'MySQL::Diff::Table' );

looking at tables called 'bar'
table 'bar' dropped
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
field 'field' added
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

DROP TABLE bar;

ALTER TABLE foo ADD COLUMN field blob;


constructing new MySQL::Diff::Database
auth args: '--user=test'
fetching table defs from file tmp.db1
creating temporary database test_mysqldiff-temp-1466538048_14534_0
running mysqldump -d '--user=test' test_mysqldiff-temp-1466538048_14534_0 
dropping temporary database test_mysqldiff-temp-1466538048_14534_0
parsing table defs
  table def [
]
  table def [
]
  table def [
]
  table def [DROP TABLE IF EXISTS foo;
]
  table def [CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


]

constructing new MySQL::Diff::Table
parsing table def 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
got table name 'foo'
line: [id int(11) NOT NULL AUTO_INCREMENT]
got field def 'id': int(11) NOT NULL AUTO_INCREMENT
line: [foreign_id int(11) NOT NULL]
got field def 'foreign_id': int(11) NOT NULL
line: [field blob]
got field def 'field': blob
line: [PRIMARY KEY (id)]
got primary key (id)
line: [) ENGINE=InnoDB DEFAULT CHARSET=utf8;]
got table options 'ENGINE=InnoDB DEFAULT CHARSET=utf8'

comparing databases
table 1 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db1'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );

looking at tables called 'foo'
comparing tables called 'foo'
table1 had field 'foreign_id'
table1 had field 'id'
table1 had field 'field'
table 2 foo = $VAR1 = bless( {
                 'source' => {
                               'auth' => '\'--user=test\'',
                               'file' => 'tmp.db2'
                             },
                 'primary_key' => '(id)',
                 'options' => 'ENGINE=InnoDB DEFAULT CHARSET=utf8',
                 'primary' => {
                                'id' => 1
                              },
                 'name' => 'foo',
                 'lines' => [
                              'CREATE TABLE foo (
',
                              '  id int(11) NOT NULL AUTO_INCREMENT,
',
                              '  foreign_id int(11) NOT NULL,
',
                              '  field blob,
',
                              '  PRIMARY KEY (id)
',
                              ') ENGINE=InnoDB DEFAULT CHARSET=utf8;
'
                            ],
                 'fields' => {
                               'foreign_id' => 'int(11) NOT NULL',
                               'id' => 'int(11) NOT NULL AUTO_INCREMENT',
                               'field' => 'blob'
                             },
                 'def' => 'CREATE TABLE foo (
  id int(11) NOT NULL AUTO_INCREMENT,
  foreign_id int(11) NOT NULL,
  field blob,
  PRIMARY KEY (id)
) ENGINE=InnoDB DEFAULT CHARSET=utf8;


'
               }, 'MySQL::Diff::Table' );


